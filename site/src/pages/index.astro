---
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import FeaturedPosts from '../components/FeaturedPosts.astro';
import { SITE_TITLE, SITE_DESCRIPTION, LINKEDIN_URL, GITHUB_URL, EMAIL } from '../consts';
import { getCollection } from 'astro:content';

// Get blog posts
const allBlogPosts = await getCollection('blog');
const featuredPosts = allBlogPosts.filter(post => post.data.featured).sort((a, b) => 
	new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
).slice(0, 3);

const recentPosts = allBlogPosts.sort((a, b) => 
	new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
).slice(0, 4);
---

<Layout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<!-- Single responsive container: block by default, grid at 2xl -->
	<div class="2xl:grid 2xl:grid-cols-[1fr_2fr_1fr] 2xl:min-h-screen">
		<!-- Left third - Current Work centered on this line -->
		<div class="hidden 2xl:flex justify-center items-start pt-12 px-4">
			<div class="w-full max-w-sm">
				<div class="bg-white border border-gray-200 rounded-lg shadow-sm p-6 sticky top-8">
					<h3 class="text-xl font-bold mb-6 text-black">Current Work</h3>
					<div class="space-y-6">
						<div class="pb-4 border-b border-gray-100">
							<h4 class="text-base font-bold mb-2">Mission Systems Division Intern</h4>
							<p class="text-sm text-gray-600 mb-3">Hume Center at Virginia Tech | June 2025 - Present</p>
							<p class="text-sm text-gray-700 leading-relaxed">
								Working on UtProSat cube satellite deploying on Blue Origin's New Glenn 2nd Launch. 
								Implementing ground-to-payload communication, experiment scheduling, and system recovery systems.
							</p>
						</div>
						<div>
							<h4 class="text-base font-bold mb-2">2025 Payload & Telemetry Lead</h4>
							<p class="text-sm text-gray-600 mb-3">Rocketry at Virginia Tech | October 2022 - Present</p>
							<p class="text-sm text-gray-700 leading-relaxed">
								Leading development of LoRa mesh networks, multi-platform telemetry systems, and active drag control 
								using Rust, Swift, and C++.
							</p>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Center third - Main content centered on this line -->
		<div class="flex justify-center">
			<div class="w-full max-w-5xl px-4 sm:px-6 lg:px-8 py-12">
			<!-- Hero Section -->
			<section class="mb-16">
				<h1 class="text-4xl md:text-5xl font-bold mb-6 text-black">
					Gregory Wainer
				</h1>
				<p class="text-xl text-gray-700 mb-8 leading-relaxed">
					Masters Electrical Engineer at Virginia Tech focusing on RF. Recent BS Computer Science graduate (2025) 
					experienced in autonomous systems, satellite communications, embedded systems, and rocketry. Currently working on mission systems 
					for cube satellites and advanced telemetry networks.
				</p>
				<div class="flex flex-col sm:flex-row gap-4">
					<a 
						href={`mailto:${EMAIL}`}
						class="inline-flex items-center px-6 py-3 border border-black text-black hover:bg-black hover:text-white transition-colors"
					>
						<svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
							<path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"/>
							<path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"/>
						</svg>
						Contact Me
					</a>
					<a 
						href="/posts"
						class="inline-flex items-center px-6 py-3 text-black hover:text-gray-700 transition-colors border border-gray-300 hover:border-gray-400"
					>
						Read My Posts
					</a>
				</div>
			</section>

			<!-- Current Work - shown in-flow below 2xl, hidden at 2xl where sidebar appears -->
			<section class="mb-16 2xl:hidden">
				<h2 class="text-3xl font-bold mb-8 text-black">Current Work</h2>
				<div class="grid md:grid-cols-2 gap-8">
					<div class="border border-gray-200 p-6">
						<h3 class="text-xl font-bold mb-3">Mission Systems Division Intern</h3>
						<p class="text-gray-600 mb-3">Hume Center at Virginia Tech | June 2025 - Present</p>
						<p class="text-gray-700">
							Working on UtProSat cube satellite deploying on Blue Origin's New Glenn 2nd Launch. 
							Implementing ground-to-payload communication, experiment scheduling, and system recovery systems.
						</p>
					</div>
					<div class="border border-gray-200 p-6">
						<h3 class="text-xl font-bold mb-3">2025 Payload & Telemetry Lead</h3>
						<p class="text-gray-600 mb-3">Rocketry at Virginia Tech | Present</p>
						<p class="text-gray-700">
							Leading development of LoRa mesh networks, multi-platform telemetry systems, and active drag control 
							using Rust, Swift, and C++.
						</p>
					</div>
				</div>
			</section>

			<!-- Skills/Technologies -->
			<section class="mb-16">
				<h2 class="text-3xl font-bold mb-8 text-black">Technical Expertise</h2>
				<div class="grid md:grid-cols-3 gap-8">
					<div>
						<h3 class="text-lg font-bold mb-4 text-black">Autonomous Systems</h3>
						<ul class="text-gray-700 space-y-2">
							<li>• PX4 & ArduPilot</li>
							<li>• ROS/ROS2</li>
							<li>• OpenCV</li>
							<li>• Visual-Inertial Odometry</li>
							<li>• Path Planning</li>
						</ul>
					</div>
					<div>
						<h3 class="text-lg font-bold mb-4 text-black">Embedded Systems</h3>
						<ul class="text-gray-700 space-y-2">
							<li>• C/C++ & Rust</li>
							<li>• RP2040 & ARM Cortex</li>
							<li>• Device Drivers</li>
							<li>• Real-time Systems</li>
							<li>• Signal Processing</li>
						</ul>
					</div>
					<div>
						<h3 class="text-lg font-bold mb-4 text-black">Communications</h3>
						<ul class="text-gray-700 space-y-2">
							<li>• Satellite Communications</li>
							<li>• LoRa Networks</li>
							<li>• GNSS/GPS</li>
							<li>• CAN Bus & NEMA 2000</li>
							<li>• RF Systems</li>
						</ul>
					</div>
				</div>
			</section>

			<!-- Featured Projects/Posts -->
			<FeaturedPosts posts={featuredPosts} title="Featured Projects" showDate={false} />

			<!-- Recent Blog Posts -->
			<section class="mb-16">
				<h2 class="text-3xl font-bold mb-8 text-black">Recent Posts</h2>
				<div class="space-y-6">
					{recentPosts.map((post) => (
						<article class="border-b border-gray-200 pb-6">
							<div class="flex flex-col gap-2 mb-2">
								<h3 class="text-xl font-bold max-w-2xl">
									<a href={`/posts/${post.id}`} class="text-black hover:text-gray-700 no-underline">
										{post.data.title}
									</a>
								</h3>
								<time class="text-gray-500 text-sm">
									{new Date(post.data.pubDate).toLocaleDateString('en-US', {
										year: 'numeric',
										month: 'long',
										day: 'numeric'
									})}
								</time>
							</div>
							<p class="text-gray-700 mb-3 leading-relaxed">
								{post.data.description}
							</p>
							<div class="flex flex-wrap gap-2">
								{post.data.tags?.slice(0, 4).map((tag) => (
									<a 
										href={`/posts/tag/${tag}`}
										class="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded hover:bg-gray-200 transition-colors"
									>
										{tag}
									</a>
								))}
							</div>
						</article>
					))}
				</div>
				<div class="text-center mt-8">
					<a 
						href="/posts"
						class="inline-flex items-center px-6 py-3 text-black hover:text-gray-700 transition-colors border border-gray-300 hover:border-gray-400"
					>
						View All Posts
					</a>
				</div>
			</section>
		</div>

		<!-- Right third - Empty for balance -->
		<div class="hidden 2xl:block"></div>
	</div>
</Layout>
